define(["rsvp"],function(u){var s={};return{subscribe:function(t,e,n){var o=!1;if(!t||"string"!=typeof t)throw"Event name not supplied to subscribe method";if(!e||"function"!=typeof e)throw"Callback not supplied to subscribe method";if(s[t]){for(var i=0,l=s[t].length;i<l;i++)if(s[t][i].callback===e){o=!0;break}}else s[t]=[];o||s[t].push({callback:e,context:n})},unsubscribe:function(t,e){if(!t||"string"!=typeof t)throw"Event name not supplied to unsubscribe method";if(!e||"object"!=typeof e)throw"Context not supplied to unsubscribe method";if(s[t])for(var n=0,o=s[t].length;n<o;n++)if(s[t][n].context===e){s[t].splice(n,1);break}},unsubscribeAll:function(){s={}},publish:function(t,e){var n,o,i=[],l=[];if(s[t]){for(var r=0,c=(n=s[t]).length;r<c;r++)l.push(u.defer()),i.push(l[r].promise);o=u.allSettled(i);for(r=0,c=n.length;r<c;r++)n[r].context?n[r].callback.call(n[r].context,e,l[r]||null):n[r].callback(e,l[r]||null);return o}}}});