define(["jquery","DoughBaseComponent","mediaQueries","utilities","ChatPopup"],function(s,t,e,n,o){"use strict";var a,p={triggerPoint:1704},h={title:"Back to top"};return a=function(t,i){a.baseConstructor.call(this,t,i,p),this.i18nStrings=i&&i.i18nStrings?i.i18nStrings:h,this.atSmallViewport=!1,this.linkHeight=0,this.hiddenClass="visually-hidden",this.showClass="back_to_top__link--shown",this.active=!1,this.scrollingToTop=!1,this.popupComponent=s(document).find('[data-dough-component="ChatPopup"]'),this.chatPopup=new o(this.popupComponent)},t.extend(a),a.componentName="BackToTop",a.prototype._setUpBTTLink=function(){var t=s.proxy(this._resize,this),i=s.proxy(this._scroll,this),o=this;this.$bttLink=s('<a class="back_to_top__link" href="#" aria-hidden="true">'+this.i18nStrings.title+'<svg xmlns="http://www.w3.org/2000/svg" class="back_to_top__link__arrow" viewBox="0 0 20.4 12.4"><path d="M20.4 10.3L10.1 0 0 10.1l2.1 2.1 8-8 8.2 8.2z"/></svg></a>'),this.$el.parentsUntil("l-body").parent().find("footer").append(this.$bttLink).find(".l-footer-secondary").addClass("back_to_top__spacer"),e.atSmallViewport()&&(this.atSmallViewport=!0),s(window).on("resize",n.debounce(t,100)),s(window).on("scroll",s.throttle(100,i)),this.$bttLink.click(function(){s(this).removeClass(o.showClass),o.chatPopup._raisedChatPopup(!1,o.atSmallViewport),o.scrollingToTop=!0,s("html, body").animate({scrollTop:0},800,function(){o.scrollingToTop=!1})})},a.prototype._getActive=function(){this._getScrollAmount()<this.config.triggerPoint&&!this.scrollingToTop?this.active=!1:this.active=!0},a.prototype._getScrollAmount=function(){return s(window).scrollTop()},a.prototype._resize=function(){e.atSmallViewport()?(this.atSmallViewport=!0,this._position(),this.$bttLink.removeClass(this.hiddenClass),this._getScrollAmount()<this.config.triggerPoint?this.chatPopup._raisedChatPopup(!1,this.atSmallViewport):this.chatPopup._raisedChatPopup(!0,this.atSmallViewport)):(this.atSmallViewport=!1,this.$bttLink.addClass(this.hiddenClass),this.chatPopup._raisedChatPopup(!1,this.atSmallViewport))},a.prototype._scroll=function(){this.atSmallViewport&&this._position()},a.prototype._position=function(){this.scrollingToTop||(this._getActive(),this.active?(this.$bttLink.addClass(this.showClass),this.chatPopup._raisedChatPopup(!0,this.atSmallViewport)):(this.$bttLink.removeClass(this.showClass),this.chatPopup._raisedChatPopup(!1,this.atSmallViewport)))},a.prototype.init=function(t){this._setUpBTTLink(),this._initialisedSuccess(t)},a});